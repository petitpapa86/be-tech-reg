# Risk Calculation Module Configuration
# Requirements: 1.2, 1.3, 2.2, 13.1
risk-calculation:
  enabled: true
  
  # Storage configuration (Requirement 2.2)
  # Supports both S3 and local filesystem storage
  storage:
    type: s3  # Options: 's3' for AWS S3, 'local' for filesystem (default: s3)
    
    # S3 storage configuration
    s3:
      bucket: regtech-risk-calculations
      region: us-east-1
      prefix: calculations/
      access-key: ${AWS_ACCESS_KEY_ID:}
      secret-key: ${AWS_SECRET_ACCESS_KEY:}
      endpoint: ${AWS_S3_ENDPOINT:}  # For LocalStack testing
      encryption: AES256
    
    # Local filesystem storage configuration
    local:
      base-path: ./data/risk-calculations
      create-directories: true
  
  # Async thread pool configuration (Requirement 13.1)
  # Purpose: Handles async risk calculation and aggregation operations
  async:
    enabled: true
    core-pool-size: 5
    max-pool-size: 10
    queue-capacity: 50
    thread-name-prefix: risk-calc-async-
    await-termination-seconds: 60
  
  # Processing configuration
  processing:
    async-enabled: true
    thread-pool-size: 5
    queue-capacity: 50
    timeout-seconds: 300  # 5 minutes
  
  # Currency conversion configuration
  currency:
    base-currency: EUR
    cache-enabled: true
    cache-ttl: 3600  # 1 hour in seconds
    provider:
      timeout: 30000  # 30 seconds
      retry-attempts: 3
      mock-enabled: false  # Use real provider by default
    
    # CurrencyAPI configuration
    api:
      api-key: ${CURRENCY_API_KEY:cur_live_uQYFLcNvMmlt34FHKxBLr7tRrEe7BV8R6GguneHl}
      timeout: 30000  # 30 seconds
      retry-attempts: 3
      enabled: true
  
  # Performance settings
  performance:
    max-concurrent-calculations: 3
    streaming-parser-enabled: true
    memory-threshold-mb: 512
  
  # Geographic classification configuration
  geographic:
    home-country: IT
    eu-countries:
      - AT  # Austria
      - BE  # Belgium
      - BG  # Bulgaria
      - HR  # Croatia
      - CY  # Cyprus
      - CZ  # Czech Republic
      - DK  # Denmark
      - EE  # Estonia
      - FI  # Finland
      - FR  # France
      - DE  # Germany
      - GR  # Greece
      - HU  # Hungary
      - IE  # Ireland
      - IT  # Italy
      - LV  # Latvia
      - LT  # Lithuania
      - LU  # Luxembourg
      - MT  # Malta
      - NL  # Netherlands
      - PL  # Poland
      - PT  # Portugal
      - RO  # Romania
      - SK  # Slovakia
      - SI  # Slovenia
      - ES  # Spain
      - SE  # Sweden
  
  # Concentration thresholds
  concentration:
    high-threshold: 0.25  # HHI > 0.25 is considered high concentration
    moderate-threshold: 0.15  # HHI between 0.15-0.25 is moderate
    precision: 4  # Decimal places for HHI calculation

---
# Development profile overrides
spring:
  config:
    activate:
      on-profile: development

risk-calculation:
  # Use local filesystem storage in development
  storage:
    type: local
  
  # Reduced thread pool for development
  async:
    core-pool-size: 2
    max-pool-size: 4
  
  processing:
    thread-pool-size: 2
  
  # Mock currency provider for development
  currency:
    provider:
      mock-enabled: true

---
# Production profile overrides
spring:
  config:
    activate:
      on-profile: production

risk-calculation:
  # Use S3 storage in production
  storage:
    type: s3
  
  # Increased thread pool for production
  async:
    core-pool-size: 10
    max-pool-size: 20
  
  processing:
    thread-pool-size: 10
  
  # Real exchange rate provider for production
  currency:
    provider:
      mock-enabled: false